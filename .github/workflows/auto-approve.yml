name: Auto approve

on:
  workflow_call:
    inputs:
      pull-request-number:
        required: true
        type: string
jobs:
  auto-approve-renovate:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    if: github.actor == 'renovate[bot]'
    steps:
      - uses: hmarr/auto-approve-action@8f929096a962e83ccdfa8afcf855f39f12d4dac7
        with:
          pull-request-number: ${{ inputs.pull-request-number }}
          review-message: 'Approving auto-generated PR'
  auto-approve-release-please:
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    if: github.actor == 'simpleclub-bot'
    steps:
      - name: Get release-please changed files
        id: changed-files
        uses: tj-actions/changed-files@v45
        with:
          files: |
            /.github/release-please-manifest.json
            **/package.json
            **/CHANGELOG.md
      - uses: hmarr/auto-approve-action@8f929096a962e83ccdfa8afcf855f39f12d4dac7
        # Only approve when the modified files have been changed
        if: steps.changed-files.outputs.only_changed == 'true'
        with:
          pull-request-number: ${{ inputs.pull-request-number }}
          review-message: 'Approving auto-generated PR'
